{"version":3,"sources":["app.js"],"names":["angular","module","HomeCtrl","constructor","$rootScope","$scope","$timeout","permissions","name","componentManager","window","ComponentManager","loggingEnabled","formData","defaultHeight","analyzeNote","text","note","content","wordCount","countWords","paragraphCount","replace","split","length","characterCount","timeToRead","timeInt","Math","round","readTime","noun","created_at","Date","toLocaleString","updated_at","streamContextItem","item","setSize","buttonPressed","action","copy","JSON","parse","stringify","title","uuid","createItem","copyNoteToClipboard","downloadText","location","href","encodeURIComponent","body","element","document","textarea","css","position","opacity","val","append","select","successful","execCommand","copied","err","console","error","toCopy","remove","s","filename","pom","createElement","setAttribute","createEvent","event","initEvent","dispatchEvent","click","$$ngIsClass","controller"],"mappings":"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","file":"app.js","sourcesContent":["'use strict';\n\nangular.module('app', [\n\n])\n;class HomeCtrl {\n  constructor($rootScope, $scope, $timeout) {\n\n    var permissions = [\n      {\n        name: \"stream-context-item\"\n      }\n    ]\n\n    let componentManager = new window.ComponentManager(permissions, function(){\n      // on ready\n    });\n    componentManager.loggingEnabled = false;\n\n    $scope.formData = {};\n    let defaultHeight = 56;\n\n\n    $scope.analyzeNote = function() {\n      var text = $scope.note.content.text;\n      $scope.wordCount = countWords(text);\n      $scope.paragraphCount = text.replace(/\\n$/gm, '').split(/\\n/).length;\n      $scope.characterCount = text.length;\n\n      var timeToRead = $scope.wordCount / 200;\n      var timeInt = Math.round(timeToRead);\n      if(timeInt == 0) {\n        $scope.readTime = \"< 1 minute\"\n      } else {\n        var noun = timeInt == 1 ? \"minute\" : \"minutes\";\n        $scope.readTime = `${timeInt} ${noun}`;\n      }\n\n      $scope.note.created_at = new Date($scope.note.created_at).toLocaleString();\n      $scope.note.updated_at = new Date($scope.note.updated_at).toLocaleString();\n    }\n\n    componentManager.streamContextItem(function(item){\n      $timeout(function(){\n        $scope.note = item;\n        $scope.analyzeNote();\n      })\n    })\n\n    componentManager.setSize(\"container\", \"100%\", defaultHeight);\n\n    $scope.buttonPressed = function(action) {\n      switch (action) {\n        case \"duplicate\":\n          var copy = JSON.parse(JSON.stringify($scope.note));\n          copy.content.title += \" (copy)\";\n          copy.created_at = new Date();\n          copy.updated_at = new Date();\n          copy.uuid = null;\n          componentManager.createItem(copy);\n          break;\n        case \"copy\":\n          $scope.copyNoteToClipboard();\n          break;\n        case \"save\":\n          downloadText($scope.note.content.title, $scope.note.content.text);\n          break;\n        case \"email\":\n          window.location.href = `mailto:?subject=${$scope.note.content.title}&body=${encodeURIComponent($scope.note.content.text)}`\n          break;\n\n      }\n    }\n\n    $scope.copyNoteToClipboard = function() {\n        var body = angular.element(document.body);\n        var textarea = angular.element('<textarea/>');\n        textarea.css({\n            position: 'fixed',\n            opacity: '0'\n        });\n\n        textarea.val($scope.note.content.text);\n        body.append(textarea);\n        textarea[0].select();\n\n        try {\n          var successful = document.execCommand('copy');\n          if (!successful) throw successful;\n          $scope.copied = true;\n          $timeout(function(){\n            $scope.copied = false;\n          }, 1000)\n        } catch (err) {\n          console.error(\"Failed to copy\", toCopy);\n        }\n\n        textarea.remove();\n    }\n  }\n}\n\nfunction countWords(s){\n  s = s.replace(/(^\\s*)|(\\s*$)/gi,\"\");//exclude  start and end white-space\n  s = s.replace(/[ ]{2,}/gi,\" \");//2 or more space to 1\n  s = s.replace(/\\n /,\"\\n\"); // exclude newline with a start spacing\n  return s.split(' ').length;\n}\n\nfunction downloadText(filename, text) {\n    var pom = document.createElement('a');\n    pom.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));\n    pom.setAttribute('download', filename);\n\n    if (document.createEvent) {\n        var event = document.createEvent('MouseEvents');\n        event.initEvent('click', true, true);\n        pom.dispatchEvent(event);\n    }\n    else {\n        pom.click();\n    }\n}\n\n// required for firefox\nHomeCtrl.$$ngIsClass = true;\n\nangular.module('app').controller('HomeCtrl', HomeCtrl);\n"]}