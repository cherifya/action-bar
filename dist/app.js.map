{"version":3,"sources":["app.js"],"names":["_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","Constructor","protoProps","staticProps","prototype","_classCallCheck","instance","TypeError","ComponentManager","permissions","onReady","_this","sentMessages","messageQueue","initialPermissions","loggingEnabled","acceptsThemes","onReadyCallback","coallesedSaving","coallesedSavingDelay","messageHandler","event","mobileSource","console","log","data","origin","JSON","parse","handleMessage","document","addEventListener","window","value","payload","action","sessionKey","componentData","activateThemes","themes","original","originalMessage","filter","message","messageId","callback","requestPermissions","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_iterator","Symbol","iterator","_step","next","done","postMessage","err","return","environment","uuid","getSelfComponentUUID","isRunningInDesktopApplication","setComponentDataValueForKey","clearComponentData","componentDataValueForKey","push","generateUUID","api","sentMessage","stringify","parent","setSize","type","width","height","bind","streamItems","contentTypes","Array","isArray","content_types","items","streamContextItem","item","selectItem","jsonObjectForItem","createItem","associateItem","createItems","_this2","mapped","map","deassociateItem","clearSelection","content_type","deleteItem","deleteItems","params","sendCustomEvent","saveItem","skipDebouncer","arguments","saveItems","_this3","updated_at","Date","saveBlock","pendingSave","clearTimeout","setTimeout","copy","assign","children","getItemAppDataValue","AppDomain","content","appData","urls","deactivateAllCustomThemes","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_iterator2","_step2","url","link","createElement","href","rel","media","className","getElementsByTagName","appendChild","elements","getElementsByClassName","forEach","call","element","disabled","parentNode","removeChild","crypto","msCrypto","buf","Uint32Array","getRandomValues","idx","replace","c","r","v","toString","d","getTime","performance","now","Math","random","floor","module","exports","angular","HomeCtrl","$rootScope","$scope","$timeout","name","componentManager","formData","defaultHeight","analyzeNote","note","createdAt","created_at","toLocaleString","updatedAt","text","wordCount","countWords","paragraphCount","split","characterCount","timeToRead","timeInt","round","readTime","noun","buttonPressed","date","toLocaleDateString","hour","minute","title","copyNoteToClipboard","copyText","downloadText","open","encodeURIComponent","body","textarea","css","position","opacity","val","append","select","successful","execCommand","copied","error","toCopy","remove","s","filename","pom","setAttribute","createEvent","initEvent","dispatchEvent","click","$$ngIsClass","controller"],"mappings":"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","file":"app.js","sourcesContent":["\"use strict\";\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ComponentManager = function () {\n  function ComponentManager(permissions, onReady) {\n    var _this = this;\n\n    _classCallCheck(this, ComponentManager);\n\n    this.sentMessages = [];\n    this.messageQueue = [];\n    this.initialPermissions = permissions;\n    this.loggingEnabled = false;\n    this.acceptsThemes = true;\n    this.onReadyCallback = onReady;\n\n    this.coallesedSaving = true;\n    this.coallesedSavingDelay = 250;\n\n    var messageHandler = function messageHandler(event, mobileSource) {\n      if (_this.loggingEnabled) {\n        console.log(\"Components API Message received:\", event.data, \"mobile?\", mobileSource);\n      }\n\n      // The first message will be the most reliable one, so we won't change it after any subsequent events,\n      // in case you receive an event from another window.\n      if (!_this.origin) {\n        _this.origin = event.origin;\n      }\n      _this.mobileSource = mobileSource;\n      // If from mobile app, JSON needs to be used.\n      var data = mobileSource ? JSON.parse(event.data) : event.data;\n      _this.handleMessage(data);\n    };\n\n    // Mobile (React Native) uses `document`, web/desktop uses `window`.addEventListener\n    // for postMessage API to work properly.\n\n    document.addEventListener(\"message\", function (event) {\n      messageHandler(event, true);\n    }, false);\n\n    window.addEventListener(\"message\", function (event) {\n      messageHandler(event, false);\n    }, false);\n  }\n\n  _createClass(ComponentManager, [{\n    key: \"handleMessage\",\n    value: function handleMessage(payload) {\n      if (payload.action === \"component-registered\") {\n        this.sessionKey = payload.sessionKey;\n        this.componentData = payload.componentData;\n        this.onReady(payload.data);\n\n        if (this.loggingEnabled) {\n          console.log(\"Component successfully registered with payload:\", payload);\n        }\n      } else if (payload.action === \"themes\") {\n        if (this.acceptsThemes) {\n          this.activateThemes(payload.data.themes);\n        }\n      } else if (payload.original) {\n        // get callback from queue\n        var originalMessage = this.sentMessages.filter(function (message) {\n          return message.messageId === payload.original.messageId;\n        })[0];\n\n        if (originalMessage.callback) {\n          originalMessage.callback(payload.data);\n        }\n      }\n    }\n  }, {\n    key: \"onReady\",\n    value: function onReady(data) {\n      if (this.initialPermissions && this.initialPermissions.length > 0) {\n        this.requestPermissions(this.initialPermissions);\n      }\n\n      var _iteratorNormalCompletion = true;\n      var _didIteratorError = false;\n      var _iteratorError = undefined;\n\n      try {\n        for (var _iterator = this.messageQueue[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n          var message = _step.value;\n\n          this.postMessage(message.action, message.data, message.callback);\n        }\n      } catch (err) {\n        _didIteratorError = true;\n        _iteratorError = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion && _iterator.return) {\n            _iterator.return();\n          }\n        } finally {\n          if (_didIteratorError) {\n            throw _iteratorError;\n          }\n        }\n      }\n\n      this.messageQueue = [];\n      this.environment = data.environment;\n      this.uuid = data.uuid;\n\n      if (this.onReadyCallback) {\n        this.onReadyCallback();\n      }\n    }\n  }, {\n    key: \"getSelfComponentUUID\",\n    value: function getSelfComponentUUID() {\n      return this.uuid;\n    }\n  }, {\n    key: \"isRunningInDesktopApplication\",\n    value: function isRunningInDesktopApplication() {\n      return this.environment === \"desktop\";\n    }\n  }, {\n    key: \"setComponentDataValueForKey\",\n    value: function setComponentDataValueForKey(key, value) {\n      this.componentData[key] = value;\n      this.postMessage(\"set-component-data\", { componentData: this.componentData }, function (data) {});\n    }\n  }, {\n    key: \"clearComponentData\",\n    value: function clearComponentData() {\n      this.componentData = {};\n      this.postMessage(\"set-component-data\", { componentData: this.componentData }, function (data) {});\n    }\n  }, {\n    key: \"componentDataValueForKey\",\n    value: function componentDataValueForKey(key) {\n      return this.componentData[key];\n    }\n  }, {\n    key: \"postMessage\",\n    value: function postMessage(action, data, callback) {\n      if (!this.sessionKey) {\n        this.messageQueue.push({\n          action: action,\n          data: data,\n          callback: callback\n        });\n        return;\n      }\n\n      var message = {\n        action: action,\n        data: data,\n        messageId: this.generateUUID(),\n        sessionKey: this.sessionKey,\n        api: \"component\"\n      };\n\n      var sentMessage = JSON.parse(JSON.stringify(message));\n      sentMessage.callback = callback;\n      this.sentMessages.push(sentMessage);\n\n      // Mobile (React Native) requires a string for the postMessage API.\n      if (this.mobileSource) {\n        message = JSON.stringify(message);\n      }\n\n      if (this.loggingEnabled) {\n        console.log(\"Posting message:\", message);\n      }\n\n      window.parent.postMessage(message, this.origin);\n    }\n  }, {\n    key: \"setSize\",\n    value: function setSize(type, width, height) {\n      this.postMessage(\"set-size\", { type: type, width: width, height: height }, function (data) {});\n    }\n  }, {\n    key: \"requestPermissions\",\n    value: function requestPermissions(permissions, callback) {\n      this.postMessage(\"request-permissions\", { permissions: permissions }, function (data) {\n        callback && callback();\n      }.bind(this));\n    }\n  }, {\n    key: \"streamItems\",\n    value: function streamItems(contentTypes, callback) {\n      if (!Array.isArray(contentTypes)) {\n        contentTypes = [contentTypes];\n      }\n      this.postMessage(\"stream-items\", { content_types: contentTypes }, function (data) {\n        callback(data.items);\n      }.bind(this));\n    }\n  }, {\n    key: \"streamContextItem\",\n    value: function streamContextItem(callback) {\n      this.postMessage(\"stream-context-item\", null, function (data) {\n        var item = data.item;\n        /*\n          When an item is saved via saveItem, its updated_at value is set client side to the current date.\n          If we make a change locally, then for whatever reason receive an item via streamItems/streamContextItem,\n          we want to ignore that change if it was made prior to the latest change we've made.\n           Update 1/22/18: However, if a user is restoring a note from version history, this change\n          will not pass through this filter and will thus be ignored. Because the client now handles\n          this case with isMetadataUpdate, we no longer need the below.\n        */\n        // if(this.streamedContextItem && this.streamedContextItem.uuid == item.uuid\n        //   && this.streamedContextItem.updated_at > item.updated_at) {\n        //   return;\n        // }\n        // this.streamedContextItem = item;\n        callback(item);\n      });\n    }\n  }, {\n    key: \"selectItem\",\n    value: function selectItem(item) {\n      this.postMessage(\"select-item\", { item: this.jsonObjectForItem(item) });\n    }\n  }, {\n    key: \"createItem\",\n    value: function createItem(item, callback) {\n      this.postMessage(\"create-item\", { item: this.jsonObjectForItem(item) }, function (data) {\n        var item = data.item;\n\n        // A previous version of the SN app had an issue where the item in the reply to create-item\n        // would be nested inside \"items\" and not \"item\". So handle both cases here.\n        if (!item && data.items && data.items.length > 0) {\n          item = data.items[0];\n        }\n\n        this.associateItem(item);\n        callback && callback(item);\n      }.bind(this));\n    }\n  }, {\n    key: \"createItems\",\n    value: function createItems(items, callback) {\n      var _this2 = this;\n\n      var mapped = items.map(function (item) {\n        return _this2.jsonObjectForItem(item);\n      });\n      this.postMessage(\"create-items\", { items: mapped }, function (data) {\n        callback && callback(data.items);\n      }.bind(this));\n    }\n  }, {\n    key: \"associateItem\",\n    value: function associateItem(item) {\n      this.postMessage(\"associate-item\", { item: this.jsonObjectForItem(item) });\n    }\n  }, {\n    key: \"deassociateItem\",\n    value: function deassociateItem(item) {\n      this.postMessage(\"deassociate-item\", { item: this.jsonObjectForItem(item) });\n    }\n  }, {\n    key: \"clearSelection\",\n    value: function clearSelection() {\n      this.postMessage(\"clear-selection\", { content_type: \"Tag\" });\n    }\n  }, {\n    key: \"deleteItem\",\n    value: function deleteItem(item) {\n      this.deleteItems([item]);\n    }\n  }, {\n    key: \"deleteItems\",\n    value: function deleteItems(items) {\n      var params = {\n        items: items.map(function (item) {\n          return this.jsonObjectForItem(item);\n        }.bind(this))\n      };\n      this.postMessage(\"delete-items\", params);\n    }\n  }, {\n    key: \"sendCustomEvent\",\n    value: function sendCustomEvent(action, data, callback) {\n      this.postMessage(action, data, function (data) {\n        callback && callback(data);\n      }.bind(this));\n    }\n  }, {\n    key: \"saveItem\",\n    value: function saveItem(item, callback) {\n      var skipDebouncer = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n      this.saveItems([item], callback, skipDebouncer);\n    }\n\n    /*\n    skipDebouncer allows saves to go through right away rather than waiting for timeout.\n    This should be used when saving items via other means besides keystrokes.\n     */\n\n  }, {\n    key: \"saveItems\",\n    value: function saveItems(items, callback) {\n      var _this3 = this;\n\n      var skipDebouncer = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n      items = items.map(function (item) {\n        item.updated_at = new Date();\n        return this.jsonObjectForItem(item);\n      }.bind(this));\n\n      var saveBlock = function saveBlock() {\n        _this3.postMessage(\"save-items\", { items: items }, function (data) {\n          callback && callback();\n        });\n      };\n\n      /*\n        Coallesed saving prevents saves from being made after every keystroke, and instead\n        waits coallesedSavingDelay before performing action. For example, if a user types a keystroke, and the clienet calls saveItem,\n        a 250ms delay will begin. If they type another keystroke within 250ms, the previously pending\n        save will be cancelled, and another 250ms delay occurs. If ater 250ms the pending delay is not cleared by a future call,\n        the save will finally trigger.\n         Note: it's important to modify saving items updated_at immediately and not after delay. If you modify after delay,\n        a delayed sync could just be wrapping up, and will send back old data and replace what the user has typed.\n      */\n      if (this.coallesedSaving == true && !skipDebouncer) {\n        if (this.pendingSave) {\n          clearTimeout(this.pendingSave);\n        }\n\n        this.pendingSave = setTimeout(function () {\n          saveBlock();\n        }, this.coallesedSavingDelay);\n      } else {\n        saveBlock();\n      }\n    }\n  }, {\n    key: \"jsonObjectForItem\",\n    value: function jsonObjectForItem(item) {\n      var copy = Object.assign({}, item);\n      copy.children = null;\n      copy.parent = null;\n      return copy;\n    }\n  }, {\n    key: \"getItemAppDataValue\",\n    value: function getItemAppDataValue(item, key) {\n      var AppDomain = \"org.standardnotes.sn\";\n      var data = item.content.appData && item.content.appData[AppDomain];\n      if (data) {\n        return data[key];\n      } else {\n        return null;\n      }\n    }\n\n    /* Themes */\n\n  }, {\n    key: \"activateThemes\",\n    value: function activateThemes(urls) {\n      this.deactivateAllCustomThemes();\n\n      if (this.loggingEnabled) {\n        console.log(\"Activating themes:\", urls);\n      }\n\n      if (!urls) {\n        return;\n      }\n\n      var _iteratorNormalCompletion2 = true;\n      var _didIteratorError2 = false;\n      var _iteratorError2 = undefined;\n\n      try {\n        for (var _iterator2 = urls[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n          var url = _step2.value;\n\n          if (!url) {\n            continue;\n          }\n\n          var link = document.createElement(\"link\");\n          link.href = url;\n          link.type = \"text/css\";\n          link.rel = \"stylesheet\";\n          link.media = \"screen,print\";\n          link.className = \"custom-theme\";\n          document.getElementsByTagName(\"head\")[0].appendChild(link);\n        }\n      } catch (err) {\n        _didIteratorError2 = true;\n        _iteratorError2 = err;\n      } finally {\n        try {\n          if (!_iteratorNormalCompletion2 && _iterator2.return) {\n            _iterator2.return();\n          }\n        } finally {\n          if (_didIteratorError2) {\n            throw _iteratorError2;\n          }\n        }\n      }\n    }\n  }, {\n    key: \"deactivateAllCustomThemes\",\n    value: function deactivateAllCustomThemes() {\n      var elements = document.getElementsByClassName(\"custom-theme\");\n\n      [].forEach.call(elements, function (element) {\n        if (element) {\n          element.disabled = true;\n          element.parentNode.removeChild(element);\n        }\n      });\n    }\n\n    /* Utilities */\n\n  }, {\n    key: \"generateUUID\",\n    value: function generateUUID() {\n      var crypto = window.crypto || window.msCrypto;\n      if (crypto) {\n        var buf = new Uint32Array(4);\n        crypto.getRandomValues(buf);\n        var idx = -1;\n        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n          idx++;\n          var r = buf[idx >> 3] >> idx % 8 * 4 & 15;\n          var v = c == 'x' ? r : r & 0x3 | 0x8;\n          return v.toString(16);\n        });\n      } else {\n        var d = new Date().getTime();\n        if (window.performance && typeof window.performance.now === \"function\") {\n          d += performance.now(); //use high-precision timer if available\n        }\n        var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n          var r = (d + Math.random() * 16) % 16 | 0;\n          d = Math.floor(d / 16);\n          return (c == 'x' ? r : r & 0x3 | 0x8).toString(16);\n        });\n        return uuid;\n      }\n    }\n  }]);\n\n  return ComponentManager;\n}();\n\nif (typeof module != \"undefined\" && typeof module.exports != \"undefined\") {\n  module.exports = ComponentManager;\n}\n\nif (window) {\n  window.ComponentManager = ComponentManager;\n}\n//# sourceMappingURL=dist.js.map\n;'use strict';\n\nangular.module('app', [\n\n])\n;class HomeCtrl {\n  constructor($rootScope, $scope, $timeout) {\n\n    var permissions = [\n      {\n        name: \"stream-context-item\"\n      }\n    ]\n\n    let componentManager = new window.ComponentManager(permissions, function(){\n      // on ready\n    });\n    componentManager.loggingEnabled = false;\n\n    $scope.formData = {};\n    let defaultHeight = 56;\n\n    $scope.analyzeNote = function(note) {\n      $scope.createdAt = new Date(note.created_at).toLocaleString();\n      $scope.updatedAt = new Date(note.updated_at).toLocaleString();\n\n      var text = note.content.text;\n      $scope.wordCount = countWords(text);\n      $scope.paragraphCount = text.replace(/\\n$/gm, '').split(/\\n/).length;\n      $scope.characterCount = text.length;\n\n      var timeToRead = $scope.wordCount / 200;\n      var timeInt = Math.round(timeToRead);\n      if(timeInt == 0) {\n        $scope.readTime = \"< 1 minute\"\n      } else {\n        var noun = timeInt == 1 ? \"minute\" : \"minutes\";\n        $scope.readTime = `${timeInt} ${noun}`;\n      }\n\n      $scope.note = note;\n    }\n\n    componentManager.streamContextItem(function(item){\n      $timeout(function(){\n        $scope.analyzeNote(item);\n      })\n    })\n\n    componentManager.setSize(\"container\", \"100%\", defaultHeight);\n\n    $scope.buttonPressed = function(action) {\n      switch (action) {\n        case \"date\":\n          var date = new Date().toLocaleDateString([], {hour: '2-digit', minute: '2-digit'});\n          $scope.note.content.text += date;\n          componentManager.saveItem($scope.note, null, true);\n          break;\n        case \"duplicate\":\n          var copy = JSON.parse(JSON.stringify($scope.note));\n          copy.content.title += \" (copy)\";\n          copy.created_at = new Date();\n          copy.updated_at = new Date();\n          copy.uuid = null;\n          componentManager.createItem(copy);\n          break;\n        case \"copy\":\n          $scope.copyNoteToClipboard();\n          $scope.copyText = \"Copied\";\n          $timeout(() => {\n            $scope.copyText = \"Copy\";\n          }, 500)\n          break;\n        case \"save\":\n          downloadText($scope.note.content.title, $scope.note.content.text);\n          break;\n        case \"email\":\n          window.open(`mailto:?subject=${$scope.note.content.title}&body=${encodeURIComponent($scope.note.content.text)}`);\n          break;\n      }\n    }\n\n    $scope.copyNoteToClipboard = function() {\n        var body = angular.element(document.body);\n        var textarea = angular.element('<textarea/>');\n        textarea.css({\n            position: 'fixed',\n            opacity: '0'\n        });\n\n        textarea.val($scope.note.content.text);\n        body.append(textarea);\n        textarea[0].select();\n\n        try {\n          var successful = document.execCommand('copy');\n          if (!successful) throw successful;\n          $scope.copied = true;\n          $timeout(function(){\n            $scope.copied = false;\n          }, 1000)\n        } catch (err) {\n          console.error(\"Failed to copy\", toCopy);\n        }\n\n        textarea.remove();\n    }\n  }\n}\n\nfunction countWords(s){\n  s = s.replace(/(^\\s*)|(\\s*$)/gi,\"\");//exclude  start and end white-space\n  s = s.replace(/[ ]{2,}/gi,\" \");//2 or more space to 1\n  s = s.replace(/\\n /,\"\\n\"); // exclude newline with a start spacing\n  return s.split(' ').length;\n}\n\nfunction downloadText(filename, text) {\n    var pom = document.createElement('a');\n    pom.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));\n    pom.setAttribute('download', filename);\n\n    if (document.createEvent) {\n        var event = document.createEvent('MouseEvents');\n        event.initEvent('click', true, true);\n        pom.dispatchEvent(event);\n    }\n    else {\n        pom.click();\n    }\n}\n\n// required for firefox\nHomeCtrl.$$ngIsClass = true;\n\nangular.module('app').controller('HomeCtrl', HomeCtrl);\n"]}